{% extends 'layout.html' %}

{% block title %}Messages{% endblock %}
{% block content_title %}Your Messages{% endblock %}

{% block content %}
    <!-- Column for Send Message Form -->
    <div class="send-message-form">
        <h3>Send a New Message</h3>
        <form method="POST" action="{{ url_for('messages') }}">
            <label for="receiver_id">Recipient:</label>
            <select name="receiver_id" required>
                <option value="" disabled selected>Select a recipient</option>
                {% for user in users %}
                    <option value="{{ user['user_id'] }}">{{ user['name'] }}</option>
                {% endfor %}
            </select><br>

            <label for="content">Message:</label>
            <textarea name="content" required></textarea><br>

            <input type="submit" value="Send Message">
        </form>
    </div>

    <div class="messages-container">
        <h3>All Messages</h3>
        <ul>
            {% for message in all_messages %}
                <li>
                    {% if message['sender_image'] %}
                        <img src="{{ url_for('static', filename=message['sender_image']) }}" alt="Sender Image" width="50">
                    {% endif %}
                    <strong>From:</strong> {{ message['sender_name'] }}<br>
                    <strong>To:</strong> {{ message['receiver_name'] }}<br>
                    <strong>Message:</strong> {{ message['content'] }}<br>
                    <strong>Sent:</strong> {{ message['timestamp'] }}
                </li>
                <hr>
            {% endfor %}
        </ul>
    </div>
{% endblock %}
